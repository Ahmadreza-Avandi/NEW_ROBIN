#!/bin/bash

# ๐ ุงุณฺฉุฑูพุช ุฑโุงุณุชุงุฑุช ุณุฑุน ูพุฑูฺู School-Proj
# ุงู ุงุณฺฉุฑูพุช ูพุฑูฺู ุฑุง ุจุฏูู rebuild ุฑโุงุณุชุงุฑุช ูโฺฉูุฏ

# ุฑูฺฏโูุง ุจุฑุง ุฎุฑูุฌ
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

print_info() {
    echo -e "${BLUE}โน๏ธ  $1${NC}"
}

print_success() {
    echo -e "${GREEN}โ $1${NC}"
}

print_warning() {
    echo -e "${YELLOW}โ๏ธ  $1${NC}"
}

print_error() {
    echo -e "${RED}โ $1${NC}"
}

print_header() {
    echo ""
    echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${BLUE}  $1${NC}"
    echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo ""
}

print_header "๐ ุฑโุงุณุชุงุฑุช ุณุฑุน ูพุฑูฺู School-Proj"

# ุจุฑุฑุณ ูุฌูุฏ docker-compose.yml
if [ ! -f "docker-compose.yml" ]; then
    print_error "ูุงู docker-compose.yml ุงูุช ูุดุฏ!"
    exit 1
fi

# ุงฺฏุฑ ุขุฑฺฏููุงู ุณุฑูุณ ุฎุงุต ุฏุงุฏู ุดุฏู ุจุงุดุฏ
if [ ! -z "$1" ]; then
    print_info "ุฏุฑ ุญุงู ุฑโุงุณุชุงุฑุช ุณุฑูุณ $1..."
    docker-compose restart $1
    print_success "ุณุฑูุณ $1 ุฑโุงุณุชุงุฑุช ุดุฏ"
    
    # ููุงุด ูุงฺฏโูุง ุณุฑูุณ
    print_info "ูุงฺฏโูุง ุงุฎุฑ ุณุฑูุณ $1:"
    docker-compose logs --tail=20 $1
else
    # ุฑโุงุณุชุงุฑุช ุชูุงู ุณุฑูุณโูุง
    print_info "ุฏุฑ ุญุงู ุฑโุงุณุชุงุฑุช ุชูุงู ุณุฑูุณโูุง..."
    docker-compose restart
    print_success "ุชูุงู ุณุฑูุณโูุง ุฑโุงุณุชุงุฑุช ุดุฏูุฏ"
    
    # ููุงุด ูุถุนุช
    print_info "ูุถุนุช ูุนู:"
    docker-compose ps
fi

print_success "ุนููุงุช ุจุง ููููุช ุงูุฌุงู ุดุฏ"

echo ""
print_info "ุจุฑุง ูุดุงูุฏู ูุถุนุช ฺฉุงูู: ./status.sh"
print_info "ุจุฑุง ูุดุงูุฏู ูุงฺฏโูุง ุฒูุฏู: ./status.sh logs"
