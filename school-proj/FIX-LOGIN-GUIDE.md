# ๐ ุฑุงูููุง ุญู ูุดฺฉู ูุงฺฏู

## ูุดฺฉู:
ุฑูุฒ ุนุจูุฑ ุฏุฑ ุฏุชุงุจุณ ุจู ุตูุฑุช ูุชู ุณุงุฏู (plain text) ุฐุฎุฑู ุดุฏูุ ูู ุณุณุชู ุงูุชุธุงุฑ ุฑูุฒ ูุด ุดุฏู ุฏุงุฑุฏ.

---

## โ ุฑุงูโุญู 1: ุงุฌุฑุง ุงุณฺฉุฑูพุช SQL (ุณุฑุนโุชุฑู)

### ุฏุฑ phpMyAdmin:

1. ูุงุฑุฏ phpMyAdmin ุดูุฏ
2. ุฏุชุงุจุณ `school` ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
3. ุจู ุชุจ "SQL" ุจุฑูุฏ
4. ุงู ฺฉูุฆุฑ ุฑุง ฺฉูพ ู ุงุฌุฑุง ฺฉูุฏ:

```sql
-- ุญุฐู ฺฉุงุฑุจุฑ ูุจู
DELETE FROM user WHERE nationalCode = '0000000000' OR nationalCode = '1';

-- ุฏุฑุฌ ฺฉุงุฑุจุฑ ูุฏุฑ ุจุง ุฑูุฒ ูุด ุดุฏู
INSERT INTO user (id, fullName, nationalCode, phoneNumber, password, roleId) 
VALUES (
  1, 
  'ูุฏุฑ ุณุณุชู', 
  '0000000000', 
  '09000000000', 
  '$2a$10$j/KCE2ssT13HxS505UR7HecVmy53oekUg.2k5/8omY6CDoFEvYgU2', 
  1
);
```

5. ุฑู "Go" ฺฉูฺฉ ฺฉูุฏ

---

## โ ุฑุงูโุญู 2: ุงุฌุฑุง ูุงู SQL

### ุฏุฑ Windows:

```cmd
cd database-migrations
fix-password.bat
```

### ุฏุฑ Linux/Mac:

```bash
cd database-migrations
mysql -u crm_user -p1234 school < fix-admin-password.sql
```

---

## โ ุฑุงูโุญู 3: ุจูโุฑูุฒุฑุณุงู ุฏุณุช

ุงฺฏุฑ ูโุฎูุงูุฏ ุฑูุฒ ูุนู ุฎูุฏุชุงู ุฑุง ูฺฏู ุฏุงุฑุฏุ ุจุงุฏ ุขู ุฑุง ูุด ฺฉูุฏ:

### 1. ุงุฌุงุฏ ูุด ุฑูุฒ ุนุจูุฑ:

ฺฉ ูุงู Node.js ูููุช ุจุณุงุฒุฏ (`hash-password.js`):

```javascript
const bcrypt = require('bcryptjs');

const password = 'admin123'; // ุฑูุฒ ุนุจูุฑ ุฏูุฎูุงู ุดูุง
const hash = bcrypt.hashSync(password, 10);

console.log('ุฑูุฒ ุนุจูุฑ:', password);
console.log('ูุด:', hash);
```

ุงุฌุฑุง ฺฉูุฏ:

```bash
node hash-password.js
```

### 2. ุจูโุฑูุฒุฑุณุงู ุฏุฑ ุฏุชุงุจุณ:

```sql
UPDATE user 
SET password = 'HASH_GENERATED_FROM_STEP_1' 
WHERE nationalCode = '0000000000';
```

---

## ๐ ุงุทูุงุนุงุช ูุฑูุฏ ูพุดโูุฑุถ

ุจุนุฏ ุงุฒ ุงุฌุฑุง ูุฑ ฺฉ ุงุฒ ุฑุงูโุญูโูุง:

```
ฺฉุฏ ูู: 0000000000
ุฑูุฒ ุนุจูุฑ: admin123
```

---

## ๐งช ุชุณุช ูุงฺฏู

1. ูุทูุฆู ุดูุฏ ุณุฑูุฑ Next.js ุฏุฑ ุญุงู ุงุฌุฑุงุณุช:
   ```bash
   cd next
   npm run dev
   ```

2. ุจู ุขุฏุฑุณ ุฒุฑ ุจุฑูุฏ:
   ```
   http://localhost:3000/login
   ```

3. ุงุทูุงุนุงุช ุฒุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ:
   - ฺฉุฏ ูู: `0000000000`
   - ุฑูุฒ ุนุจูุฑ: `admin123`

4. ุงฺฏุฑ ูููู ุดุฏุฏุ ุจู ุฏุงุดุจูุฑุฏ ููุชูู ูโุดูุฏ

---

## ๐ ุนุจโุงุจ

### ุฎุทุง: 401 Unauthorized

**ุนูุชโูุง ุงุญุชูุงู:**

1. **ุฑูุฒ ุนุจูุฑ ูุด ูุดุฏู ุงุณุช**
   - ุฑุงูโุญู: ฺฉ ุงุฒ ุฑูุดโูุง ุจุงูุง ุฑุง ุงุฌุฑุง ฺฉูุฏ

2. **ฺฉุฏ ูู ุงุดุชุจุงู ุงุณุช**
   - ุจุฑุฑุณ ฺฉูุฏ: `SELECT * FROM user WHERE roleId = 1;`
   - ฺฉุฏ ูู ุจุงุฏ ุฏููุงู `0000000000` ุจุงุดุฏ (10 ุตูุฑ)

3. **ุฏุชุงุจุณ ุงุดุชุจุงู ุงุณุช**
   - ูุทูุฆู ุดูุฏ ุจู ุฏุชุงุจุณ `school` ูุชุตู ูุณุชุฏ
   - ุจุฑุฑุณ ฺฉูุฏ: `SELECT DATABASE();`

4. **ุฌุฏูู user ูุฌูุฏ ูุฏุงุฑุฏ**
   - ุจุฑุฑุณ ฺฉูุฏ: `SHOW TABLES;`
   - ุงฺฏุฑ ูุฌูุฏ ูุฏุงุฑุฏุ migrations ุฑุง ุงุฌุฑุง ฺฉูุฏ

### ุจุฑุฑุณ ุฑูุฒ ุนุจูุฑ ุฏุฑ ุฏุชุงุจุณ:

```sql
SELECT 
  id,
  fullName,
  nationalCode,
  LEFT(password, 20) as password_preview,
  roleId
FROM user 
WHERE roleId = 1;
```

ุงฺฏุฑ `password_preview` ุจุง `$2a$10$` ุดุฑูุน ูโุดูุฏุ ุฑูุฒ ุจู ุฏุฑุณุช ูุด ุดุฏู ุงุณุช.

---

## ๐ ูฺฉุงุช ููู

1. **ูุฑฺฏุฒ** ุฑูุฒ ุนุจูุฑ ุฑุง ุจู ุตูุฑุช ูุชู ุณุงุฏู ุฐุฎุฑู ูฺฉูุฏ
2. **ููุดู** ุงุฒ bcrypt ุจุฑุง ูุด ฺฉุฑุฏู ุฑูุฒ ุงุณุชูุงุฏู ฺฉูุฏ
3. **ุญุชูุงู** ุจุนุฏ ุงุฒ ุงููู ูุฑูุฏุ ุฑูุฒ ุนุจูุฑ ุฑุง ุชุบุฑ ุฏูุฏ
4. ุจุฑุง ูุญุท productionุ ุงุฒ ุฑูุฒูุง ููโุชุฑ ุงุณุชูุงุฏู ฺฉูุฏ

---

## ๐ ูุฑุงุญู ุจุนุฏ

ุจุนุฏ ุงุฒ ูุงฺฏู ูููู:

1. ุจู ูพุฑููุงู ุฎูุฏ ุจุฑูุฏ
2. ุฑูุฒ ุนุจูุฑ ุฑุง ุชุบุฑ ุฏูุฏ
3. ุงุฒ ููู ูุฏุฑุช ุงุณุชูุงุฏู ฺฉูุฏ:
   - ุงูุฒูุฏู ูุนูู
   - ุงุฌุงุฏ ฺฉูุงุณ
   - ุงุฌุงุฏ ุฏุฑุณ
   - ูุฏุฑุช ุฏุงูุดโุขููุฒุงู

---

## ๐ก ุงุทูุงุนุงุช ุชฺฉูู

### ุณุงุฎุชุงุฑ ูุด bcrypt:

```
$2a$10$j/KCE2ssT13HxS505UR7HecVmy53oekUg.2k5/8omY6CDoFEvYgU2
โ  โ  โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ  โ                        ูุด (hash)
โ  โ  โโ ููฺฉ (salt)
โ  โโ ูุฒูู (cost factor = 10)
โโ ุงูฺฏูุฑุชู (bcrypt 2a)
```

### ฺุฑุง bcryptุ

- ุงููโุชุฑู ุฑูุด ูุด ฺฉุฑุฏู ุฑูุฒ ุนุจูุฑ
- ููุงูู ุฏุฑ ุจุฑุงุจุฑ ุญููุงุช brute-force
- ุฏุงุฑุง salt ฺฉุชุง ุจุฑุง ูุฑ ุฑูุฒ
- ุงุณุชุงูุฏุงุฑุฏ ุตูุนุช

---

## ๐ ฺฉูฺฉ ุจุดุชุฑ

ุงฺฏุฑ ููฺูุงู ูุดฺฉู ุฏุงุฑุฏ:

1. ูุงฺฏโูุง Next.js ุฑุง ุจุฑุฑุณ ฺฉูุฏ
2. Console ูุฑูุฑฺฏุฑ ุฑุง ฺฺฉ ฺฉูุฏ (F12)
3. ูุทูุฆู ุดูุฏ MySQL ุฏุฑ ุญุงู ุงุฌุฑุงุณุช
4. ุงุชุตุงู ุจู ุฏุชุงุจุณ ุฑุง ุชุณุช ฺฉูุฏ
