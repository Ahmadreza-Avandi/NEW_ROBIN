#!/bin/bash

# Ø¨Ø±Ø±Ø³ÛŒ API Ù‡Ø§

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ðŸ” Ø¨Ø±Ø±Ø³ÛŒ API Ù‡Ø§ÛŒ School"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

echo "1ï¸âƒ£ ØªØ³Øª Ù…Ø³ØªÙ‚ÛŒÙ… Nest.js (Ù¾ÙˆØ±Øª 3002):"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
curl -v http://localhost:3002/grades 2>&1 | head -20
echo ""

echo "2ï¸âƒ£ ØªØ³Øª Ø§Ø² Ø·Ø±ÛŒÙ‚ Nginx:"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
curl -v https://sch.ahmadreza-avandi.ir/api/grades 2>&1 | head -20
echo ""

echo "3ï¸âƒ£ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Nest.js (20 Ø®Ø· Ø¢Ø®Ø±):"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
docker-compose logs --tail=20 nestjs
echo ""

echo "4ï¸âƒ£ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Nginx (10 Ø®Ø· Ø¢Ø®Ø±):"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
tail -10 /var/log/nginx/error.log
echo ""

echo "5ï¸âƒ£ ÙˆØ¶Ø¹ÛŒØª containers:"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
docker-compose ps
echo ""

echo "6ï¸âƒ£ ØªØ³Øª Ø§ØªØµØ§Ù„ Nest.js Ø¨Ù‡ MySQL:"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
docker-compose exec -T nestjs sh -c "echo 'Testing DB connection...'" 2>&1 || echo "Container not running"
echo ""
