# ğŸ“ School-Proj - Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ù†Ù‡Ø§ÛŒÛŒ

## ğŸ¯ Ø®Ù„Ø§ØµÙ‡

Ù¾Ø±ÙˆÚ˜Ù‡ School-Proj Ø­Ø§Ù„Ø§ **Ú©Ø§Ù…Ù„Ø§Ù‹ Ù…Ø³ØªÙ‚Ù„** Ø§Ø² Ù¾Ø±ÙˆÚ˜Ù‡ CRM Ø§Ø³Øª Ùˆ Ø±ÙˆÛŒ Ø¯Ø§Ù…Ù†Ù‡ `sch.ahmadreza-avandi.ir` Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

## âš¡ Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ø³Ø±ÛŒØ¹ (3 Ø¯Ø³ØªÙˆØ±)

```bash
cd school-proj

# 1. Ø§ÛŒØ¬Ø§Ø¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ .env
bash setup-env.sh

# 2. Ø¯Ø±ÛŒØ§ÙØª SSL (Ø§Ú¯Ø± Ù‚Ø¨Ù„Ø§Ù‹ Ø¯Ø±ÛŒØ§ÙØª Ù†Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯)
sudo bash get-ssl-manual.sh

# 3. Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ú©Ø§Ù…Ù„
bash deploy-complete.sh
```

## ğŸ“‹ Ø¬Ø²Ø¦ÛŒØ§Øª

### Ù¾ÙˆØ±Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ (Ø¨Ø¯ÙˆÙ† ØªØ¯Ø§Ø®Ù„ Ø¨Ø§ CRM)

| Ø³Ø±ÙˆÛŒØ³ | Ù¾ÙˆØ±Øª Ù…Ø­Ù„ÛŒ | Ø¯Ø§Ù…Ù†Ù‡ |
|-------|-----------|-------|
| Next.js | 3003 | https://sch.ahmadreza-avandi.ir |
| Nest.js | 3002 | https://sch.ahmadreza-avandi.ir/api |
| Python | 5001 | https://sch.ahmadreza-avandi.ir/python-api |
| MySQL | 3307 | localhost:3307 |
| Redis | 6380 | localhost:6380 |
| phpMyAdmin | 8083 | https://sch.ahmadreza-avandi.ir/phpmyadmin |
| Redis Commander | 8084 | https://sch.ahmadreza-avandi.ir/redis-commander |

### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ .env

Ù¾Ø±ÙˆÚ˜Ù‡ Ø§Ø² 4 ÙØ§ÛŒÙ„ .env Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:

1. **`.env`** - ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ØµÙ„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡
2. **`nest/.env`** - ØªÙ†Ø¸ÛŒÙ…Ø§Øª Backend (Nest.js)
3. **`next/.env.local`** - ØªÙ†Ø¸ÛŒÙ…Ø§Øª Frontend (Next.js) - Development
4. **`next/.env.production`** - ØªÙ†Ø¸ÛŒÙ…Ø§Øª Frontend (Next.js) - Production

Ø§Ø³Ú©Ø±ÛŒÙ¾Øª `setup-env.sh` Ù‡Ù…Ù‡ Ø§ÛŒÙ†Ù‡Ø§ Ø±Ùˆ Ø®ÙˆØ¯Ú©Ø§Ø± Ù…ÛŒâ€ŒØ³Ø§Ø²Ù‡.

## ğŸš€ Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯

### Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ

```bash
# Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø³Ø±ÙˆØ± (ÙÙ‚Ø· Ø¨Ø§Ø± Ø§ÙˆÙ„)
sudo bash setup-server.sh

# Ø§ÛŒØ¬Ø§Ø¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ .env
bash setup-env.sh

# Ø¯Ø±ÛŒØ§ÙØª SSL (ÙÙ‚Ø· Ø¨Ø§Ø± Ø§ÙˆÙ„)
sudo bash get-ssl-manual.sh

# Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ú©Ø§Ù…Ù„
bash deploy-complete.sh
```

### Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØªÛŒ

```bash
# Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª
bash status.sh

# Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¯Ù‡
bash status.sh logs

# Ø±ÛŒâ€ŒØ§Ø³ØªØ§Ø±Øª Ú©Ù„ Ù¾Ø±ÙˆÚ˜Ù‡
bash restart.sh

# Ø±ÛŒâ€ŒØ§Ø³ØªØ§Ø±Øª ÛŒÚ© Ø³Ø±ÙˆÛŒØ³
bash restart.sh nextjs

# ØªÙˆÙ‚Ù Ù¾Ø±ÙˆÚ˜Ù‡
bash stop.sh
```

### Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ú©Ù…Ú©ÛŒ

```bash
# Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ nginx
sudo bash fix-nginx-and-continue.sh

# Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± (Ø¨Ø¯ÙˆÙ† Ø³ÙˆØ§Ù„)
bash deploy-auto.sh
```

## ğŸ”§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Environment Variables

### Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ

```bash
DOMAIN=sch.ahmadreza-avandi.ir
MYSQL_ROOT_PASSWORD=rootpassword
MYSQL_DATABASE=mydatabase
MYSQL_USER=user
MYSQL_PASSWORD=userpassword
JWT_SECRET=<auto-generated>
```

### Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Nest.js

```bash
DATABASE_URL=mysql://root:rootpassword@mysql:3306/mydatabase
REDIS_HOST=redis
REDIS_PORT=6379
FACE_DETECTION_URL=http://pythonserver:5000
JWT_SECRET=<auto-generated>
NODE_ENV=production
DOMAIN=sch.ahmadreza-avandi.ir
```

### Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Next.js

```bash
NEXT_PUBLIC_API_URL=https://sch.ahmadreza-avandi.ir/api
NEXT_PUBLIC_PYTHON_API_URL=https://sch.ahmadreza-avandi.ir/python-api
NESTJS_API_URL=http://nestjs:3001
PYTHON_API_URL=http://pythonserver:5000
```

## ğŸ“Š Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡

```
school-proj/
â”œâ”€â”€ next/                    # Frontend (Next.js)
â”‚   â”œâ”€â”€ .env.local          # ØªÙ†Ø¸ÛŒÙ…Ø§Øª development
â”‚   â””â”€â”€ .env.production     # ØªÙ†Ø¸ÛŒÙ…Ø§Øª production
â”œâ”€â”€ nest/                    # Backend (Nest.js)
â”‚   â””â”€â”€ .env                # ØªÙ†Ø¸ÛŒÙ…Ø§Øª backend
â”œâ”€â”€ faceDetectionWithCamera/ # Python API
â”œâ”€â”€ trainer/                 # Ù…Ø§Ú˜ÙˆÙ„ Ø¢Ù…ÙˆØ²Ø´
â”œâ”€â”€ .env                     # ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ØµÙ„ÛŒ
â”œâ”€â”€ docker-compose.yml       # Ú©Ø§Ù†ÙÛŒÚ¯ Docker
â”œâ”€â”€ nginx-config.conf        # Ú©Ø§Ù†ÙÛŒÚ¯ Nginx
â”œâ”€â”€ setup-env.sh            # Ø§ÛŒØ¬Ø§Ø¯ .env Ù‡Ø§
â”œâ”€â”€ setup-ssl.sh            # Ø¯Ø±ÛŒØ§ÙØª SSL
â”œâ”€â”€ get-ssl-manual.sh       # Ø¯Ø±ÛŒØ§ÙØª SSL (Ø³Ø§Ø¯Ù‡)
â”œâ”€â”€ deploy-complete.sh      # Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ú©Ø§Ù…Ù„
â”œâ”€â”€ deploy-auto.sh          # Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±
â”œâ”€â”€ status.sh               # Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª
â”œâ”€â”€ restart.sh              # Ø±ÛŒâ€ŒØ§Ø³ØªØ§Ø±Øª
â””â”€â”€ stop.sh                 # ØªÙˆÙ‚Ù
```

## ğŸ” Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ

### Ù…Ø´Ú©Ù„: ÙØ§ÛŒÙ„ .env ÛŒØ§ÙØª Ù†Ø´Ø¯

```bash
bash setup-env.sh
```

### Ù…Ø´Ú©Ù„: SSL ÛŒØ§ÙØª Ù†Ø´Ø¯

```bash
sudo bash get-ssl-manual.sh
```

### Ù…Ø´Ú©Ù„: Ù¾ÙˆØ±Øª Ø¯Ø± Ø­Ø§Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡

```bash
# Ø¨Ø±Ø±Ø³ÛŒ Ù¾ÙˆØ±Øªâ€ŒÙ‡Ø§
sudo netstat -tulpn | grep -E "3003|3002|5001|3307|6380"

# ØªÙˆÙ‚Ù containers
docker-compose down
```

### Ù…Ø´Ú©Ù„: nginx Ø®Ø·Ø§ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯

```bash
# Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙ‚Øª
sudo bash fix-nginx-and-continue.sh

# ØªØ³Øª nginx
sudo nginx -t

# Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø§Ú¯
sudo tail -f /var/log/nginx/error.log
```

### Ù…Ø´Ú©Ù„: Container Ø§Ø¬Ø±Ø§ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯

```bash
# Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø§Ú¯
docker-compose logs [service-name]

# Ø±ÛŒâ€ŒØ§Ø³ØªØ§Ø±Øª
docker-compose restart [service-name]

# Ø¨ÛŒÙ„Ø¯ Ù…Ø¬Ø¯Ø¯
docker-compose up -d --build [service-name]
```

## ğŸ” Ø§Ù…Ù†ÛŒØª

1. **SSL**: ØªÙ…Ø§Ù… Ø§Ø±ØªØ¨Ø§Ø·Ø§Øª Ø§Ø² Ø·Ø±ÛŒÙ‚ HTTPS
2. **Passwords**: Ø±Ù…Ø²Ù‡Ø§ÛŒ Ù‚ÙˆÛŒ Ø¯Ø± .env
3. **JWT**: Secret key ÛŒÚ©ØªØ§ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù†ØµØ¨
4. **Firewall**: ÙÙ‚Ø· Ù¾ÙˆØ±Øªâ€ŒÙ‡Ø§ÛŒ 80 Ùˆ 443 Ø¨Ø§Ø²
5. **Isolation**: Ø¬Ø¯Ø§Ø³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ø§Ø² CRM

## ğŸ“ Ù†Ú©Ø§Øª Ù…Ù‡Ù…

1. âœ… Ù¾Ø±ÙˆÚ˜Ù‡ Ú©Ø§Ù…Ù„Ø§Ù‹ Ù…Ø³ØªÙ‚Ù„ Ø§Ø² CRM Ø§Ø³Øª
2. âœ… Ù¾ÙˆØ±Øªâ€ŒÙ‡Ø§ÛŒ Ù…ØªÙØ§ÙˆØª Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ØªØ¯Ø§Ø®Ù„
3. âœ… Ø¯Ø§Ù…Ù†Ù‡ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡: sch.ahmadreza-avandi.ir
4. âœ… Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ø±ÙˆÛŒ Ù¾ÙˆØ±Øª 3307
5. âœ… Redis Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ø±ÙˆÛŒ Ù¾ÙˆØ±Øª 6380
6. âœ… SSL Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ù…Ù†Ù‡ Ø¬Ø¯ÛŒØ¯

## ğŸ‰ Ø¨Ø¹Ø¯ Ø§Ø² Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ù…ÙˆÙÙ‚

Ù¾Ø±ÙˆÚ˜Ù‡ Ø´Ù…Ø§ Ø¯Ø± Ø§ÛŒÙ† Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ø§Ø³Øª:

- ğŸŒ **ÙˆØ¨â€ŒØ³Ø§ÛŒØª**: https://sch.ahmadreza-avandi.ir
- ğŸ”§ **API**: https://sch.ahmadreza-avandi.ir/api
- ğŸ **Python**: https://sch.ahmadreza-avandi.ir/python-api
- ğŸ’¾ **phpMyAdmin**: https://sch.ahmadreza-avandi.ir/phpmyadmin
- ğŸ“Š **Redis**: https://sch.ahmadreza-avandi.ir/redis-commander

---

**Ù†Ú©ØªÙ‡**: Ù‡Ù…ÛŒØ´Ù‡ Ù‚Ø¨Ù„ Ø§Ø² Ø¯ÛŒÙ¾Ù„ÙˆÛŒØŒ Ø§Ø² Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¨Ú©Ø§Ù¾ Ø¨Ú¯ÛŒØ±ÛŒØ¯! ğŸ”’
